!function(a,b){'use strict';b.planar=a;var c={mixin:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},indexOf:function(a,b){if(a)for(var c=0;c<b.length;c++)if(b[c]===a)return c;return-1},indexOfById:function(a,b){if(a)for(var c=0;c<b.length;c++)if(b[c].id===a)return c;return-1},remove:function(a,b){var c=!1,d=this.indexOf(a,b);return d>=0&&(b.splice(d,1),c=!0),c},removeById:function(a,b){var c=!1,d=this.indexOfById(a,b);return d>=0&&(b.splice(d,1),c=!0),c},keys:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},get:function(){var a=this.convertVarArgs(arguments),b=a[0];a.shift();for(var c=a,d=0;d<c.length;++d){if(this.isUndefined(b[c[d]]))return void 0;b=b[c[d]]}return b},values:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},isFunction:function(a){return"function"==typeof a},isUndefined:function(a){return"undefined"==typeof a},isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},isOfType:function(a,b){return a.constructor===b},checkExists:function(a,b){if(!c.exists(b))throw{message:a+" must be specified"}},exists:function(a){return!c.isUndefined(a)&&null!==a},checkInArray:function(a,b,c){if(this.checkExists(a,b),-1===this.indexOf(b,c))throw{message:a+" must be one of "+c}},checkArray:function(a,b){if(!this.isArray(b))throw{message:a+" must be an array"}},checkNotEmpty:function(a,b){if(""===b)throw{message:a+" must not be empty"}},checkType:function(a,b,c){if(!this.isOfType(b,c))throw{message:a+" must be of type "+c}},generateId:function(){var a=1;return function(){return a++}}(),convertVarArgs:function(a){return a.length>0&&c.isArray(a[0])?a[0]:Array.prototype.slice.call(a)},randomInteger:function(a,b){return Math.floor(Math.random()*b)+a}},d=1,e=2,f=3,g="_type",h=function(){return{on:function(a,b){c.checkExists("Event",a),c.checkExists("Callback",b),this.eventCallbacks=this.eventCallbacks||{},this.eventCallbacks[a]=this.eventCallbacks[a]||[],this.eventCallbacks[a].push(b)},off:function(a){c.checkExists("Event",a),this.eventCallbacks&&delete this.eventCallbacks[a]},trigger:function(a){c.checkExists("Event",a);var b,d,e;if(this.eventCallbacks&&this.eventCallbacks[a]){d=[].slice.call(arguments,1),b=this.eventCallbacks[a];for(var f=0;!e&&f<b.length;f++)e=b[f].apply(this,[a].concat(d))===!1}}}}(),i=function(){return{initProperties:function(a){this.properties=[],this.graph=a},setProperty:function(a,b){c.checkExists("Property key",a),c.checkExists("Property value",b),c.checkNotEmpty("Property key",a);var d=this.properties[a];this.properties[a]=b,this.graph.indexManager.updateKeyIndexValue(a,b,d,this)},getProperty:function(a){return c.isUndefined(this.properties[a])?null:this.properties[a]},getPropertyKeys:function(){return c.keys(this.properties)},removeProperty:function(a){var b=this.getProperty(a);return delete this.properties[a],this.graph.indexManager.removeKeyIndexValue(a,b,this),b},getId:function(){return this.id},getGraph:function(){return this.graph}}}(),j=function(){function a(a,b,d,e,f){c.checkExists("ID",a),c.checkExists("Out vertex",b),c.checkExists("In vertex",d),this.id=a,this.outVertex=b,this.inVertex=d,this.label=e,this.initProperties(f)}return c.mixin(a.prototype,i),c.mixin(a.prototype,{getLabel:function(){return this.label},getInVertex:function(){return this.inVertex},getOutVertex:function(){return this.outVertex},getVertex:function(a){if(a===d)return this.outVertex;if(a===e)return this.inVertex;throw{message:"Invalid direction. Must be either IN or OUT"}},remove:function(){this.graph.removeEdge(this)}}),a}(),k=function(){function a(a,b){this.id=a,this.inEdges={},this.outEdges={},this.ui={},this.initProperties(b)}return c.mixin(a.prototype,i),c.mixin(a.prototype,{getEdges:function(a){var b=Array.prototype.slice.call(arguments,1);return new s(this).labels(b).direction(a).edges()},getVertices:function(a){var b=Array.prototype.slice.call(arguments,1);return new s(this).labels(b).direction(a).vertices()},addEdge:function(a,b){return this.graph.addEdge(null,this,b,a)},remove:function(){this.graph.removeVertex(this)},query:function(){return new s(this)}}),a}(),l=function(){function a(a,b){this.vertices={},this.edges={},this.indexManager=new n(this),c.exists(a)&&c.exists(b)&&(this.renderer=new G(this,a,b),this.renderer.init())}return c.mixin(a.prototype,h),c.mixin(a.prototype,{addVertex:function(a){if(c.isUndefined(a)||null===a)for(a=c.generateId();null!==this.getVertex(a);)a=c.generateId();var b=this.getVertex(a);if(b)throw{message:"Vertex already exists with the given ID"};return b=new k(a,this),this.vertices[a]=b,this.trigger("vertexAdded",b),b},getVertex:function(a){return c.checkExists("ID",a),c.isUndefined(this.vertices[a])?null:this.vertices[a]},removeVertex:function(a){c.checkExists("Vertex",a);var b=this.getVertex(a.id);if(b){var d;for(d in b.inEdges)this.removeEdge(b.inEdges[d]);for(d in b.outEdges)this.removeEdge(b.outEdges[d]);this.indexManager.removeElement(b),delete this.vertices[b.id],this.trigger("vertexRemoved",b)}},getVertices:function(a,b){return c.isUndefined(a)||null===a?c.values(this.vertices):new t(this).has(a,b).vertices()},addEdge:function(a,b,d,e){if(c.isUndefined(a)||null===a)for(a=c.generateId();null!==this.getEdge(a);)a=c.generateId();var f=new j(a,b,d,e,this);if(this.edges[a])throw{message:"Edge already exists with the given ID"};return this.edges[a]=f,b.outEdges[f.id]=f,d.inEdges[f.id]=f,this.trigger("edgeAdded",f),f},getEdge:function(a){return c.checkExists("ID",a),c.isUndefined(this.edges[a])?null:this.edges[a]},removeEdge:function(a){if(a){var b=this.edges[a.id];b&&(this.indexManager.removeElement(b),delete this.edges[b.id],delete b.outVertex.outEdges[b.id],delete b.inVertex.inEdges[b.id],this.trigger("edgeRemoved",a))}},getEdges:function(a,b){return c.isUndefined(a)||null===a?c.values(this.edges):new t(this).has(a,b).edges()},forEachVertex:function(a){if(c.isFunction(a))for(var b in this.vertices)if(a(this.vertices[b]))return},forEachEdge:function(a){if(c.isFunction(a))for(var b in this.edges)if(a(this.edges[b]))return},query:function(){return new t(this)},createIndex:function(a,b){return this.indexManager.createIndex(a,b)},getIndex:function(a,b){return this.indexManager.getIndex(a,b)},getIndices:function(){return this.indexManager.getIndices()},dropIndex:function(a){this.indexManager.dropIndex(a)},createKeyIndex:function(a,b){return this.indexManager.createKeyIndex(a,b)},getIndexedKeys:function(a){return this.indexManager.getIndexedKeys(a)},dropKeyIndex:function(a,b){this.indexManager.dropKeyIndex(a,b)},render:function(){this.renderer.render()}}),a}(),m=function(){function a(a,b){c.checkExists("Name",a),c.checkExists("Type",b),this.name=a,this.type=b,this.index={}}return c.mixin(a.prototype,{getIndexName:function(){return this.name},getIndexType:function(){return this.type},put:function(a,b,d){c.checkExists("Key",a),c.checkExists("Value",b),c.checkType("Element",d,this.type);var e=this.index[a]=this.index[a]||{},f=e[b]=e[b]||{};f[d.getId()]=d},putAll:function(a,b){c.checkExists("Key",a),c.checkArray("Elements",b);for(var d=0;d<b.length;d++){var e=b[d];c.checkType("Element "+d,e,this.type);var f=e.getProperty(a);f&&this.put(a,f,e)}},get:function(a,b){var d=this.index[a]||{},e=d[b]||{};return c.values(e)},count:function(a,b){return this.get(a,b).length},remove:function(a,b,d){c.checkType("Element",d,this.type);var e=this.index[a];if(e){var f=e[b];f&&delete f[d.getId()]}},removeElement:function(a){c.checkType("Element",a,this.type);for(var b in this.index){var d=this.index[b];if(d)for(var e in d)delete d[e][a.getId()]}},removeKey:function(a){delete this.index[a]},getIndexedKeys:function(){return c.keys(this.index)},update:function(a,b,d,e){c.indexOf(a,this.getIndexedKeys())>-1&&(c.isUndefined(d)||this.remove(a,d,e),this.put(a,b,e))}}),a}(),n=function(){function a(a){c.checkExists("Graph",a),this.graph=a,this.indices={},this.vertexKeyIndex=new m(name,k),this.edgeKeyIndex=new m(name,j)}function b(a,b,c){return a.removeKey(c),a.index[c]={},a.putAll(c,b),a}return c.mixin(a.prototype,{createIndex:function(a,b){if(c.checkExists("Name",a),c.checkExists("Type",b),this.indices.hasOwnProperty(a))throw{message:"Index already exists"};var d=new m(a,b);return this.indices[a]=d,d},createKeyIndex:function(a,c){if(c===k)return b(this.vertexKeyIndex,this.graph.getVertices(),a);if(c===j)return b(this.edgeKeyIndex,this.graph.getEdges(),a);throw{message:"Invalid type"}},getIndex:function(a,b){var d=this.indices[a];if(c.isUndefined(d))return null;if(b!==d.getIndexType())throw{message:"Invalid index type"};return d},getIndices:function(){return c.values(this.indices)},getIndexedKeys:function(a){return this._getKeyIndex(a).getIndexedKeys()},dropIndex:function(a){delete this.indices[a]},dropKeyIndex:function(a,b){this._getKeyIndex(b).removeKey(a)},removeElement:function(a){for(var b=c.values(this.indices),d=0;d<b.length;d++){var e=b[d];c.isOfType(a,e.getIndexType())&&e.removeElement(a)}this._getKeyIndex(a.constructor).removeElement(a)},updateKeyIndexValue:function(a,b,c,d){this._getKeyIndex(d.constructor).update(a,b,c,d)},removeKeyIndexValue:function(a,b,c){this._getKeyIndex(c.constructor).remove(a,b,c)},fetchFirstMatching:function(a,b){for(var d=this.getIndexedKeys(a),e=0;e<b.length;e++){var f=b[e];if(f.predicate===p.EQUAL&&c.indexOf(f.key,d)>-1)return this._getKeyIndex(a).get(f.key,f.value)}return null},_getKeyIndex:function(a){if(a===k)return this.vertexKeyIndex;if(a===j)return this.edgeKeyIndex;throw{message:"Invalid type"}}}),a}(),o=function(){function a(){this.labels=c.convertVarArgs(arguments)}return c.mixin(a.prototype,{matches:function(a){for(var b=0;b<this.labels.length;b++)if(this.labels[b]===a.getLabel())return!0;return!1}}),a}(),p=function(){return{EQUAL:{evaluate:function(a,b){return a===b}},NOT_EQUAL:{evaluate:function(a,b){return a!==b}},GREATER_THAN:{evaluate:function(a,b){return null!==a&&null!==b&&a>b}},LESS_THAN:{evaluate:function(a,b){return null!==a&&null!==b&&b>a}},GREATER_THAN_EQUAL:{evaluate:function(a,b){return null!==a&&null!==b&&a>=b}},LESS_THAN_EQUAL:{evaluate:function(a,b){return null!==a&&null!==b&&b>=a}}}}(),q=(function(){'use strict';return{IN:{evaluate:function(a,b){return c.checkArray("Second argument",b),c.indexOf(a,b)>-1}},NOT_IN:{evaluate:function(a,b){return c.checkArray("Second argument",b),-1===c.indexOf(a,b)}}}}(),function(){function a(a,b,d){c.checkExists("Key",a),c.checkExists("Predicate",b),this.key=a,this.value=d,this.predicate=b}return c.mixin(a.prototype,{matches:function(a){return this.predicate.evaluate(a.getProperty(this.key),this.value)}}),a}()),r=function(){function a(a,b,d,e){var f=0;c.isArray(a)||(a=[a]);for(var g=[],h=0;h<a.length;h++){var i=a[h];(c.isOfType(a[h],k)||c.isOfType(a[h],j))&&(i=[i]);for(var l in i){for(var m=i[l],n=!1,o=0;o<b.length;o++)if(!b[o].matches(m)){n=!0;break}if(!n){if(!(++f<=d))return g;g.push(e?e(m):m)}}}return g}return{initQuery:function(){this.queryLimit=Number.MAX_VALUE,this.hasFilters=[]},limit:function(a){return this.queryLimit=a,this},has:function(a,b,d){return this.hasFilters.push(c.isUndefined(d)||null===d?c.isUndefined(b)||null===b?new q(a,p.NOT_EQUAL,null):new q(a,p.EQUAL,b):new q(a,b,d)),this},hasNot:function(a,b){return this.hasFilters.push(c.isUndefined(b)||null===b?new q(a,p.EQUAL,null):new q(a,p.NOT_EQUAL,b)),this},interval:function(a,b,c){return this.hasFilters.push(new q(a,p.GREATER_THAN_EQUAL,b)),this.hasFilters.push(new q(a,p.LESS_THAN,c)),this},edges:function(){var b=this.getInitialEdges(),c=this.getBaseFilters();return c=c.concat(this.hasFilters),a(b,c,this.queryLimit)},vertices:function(){var b=this.getInitialVertices(),c=this.getBaseFilters();return c=c.concat(this.hasFilters),a(b,c,this.queryLimit,this.resultExtractor(this))}}}(),s=function(){function a(a){c.checkExists("Vertex",a),this.initQuery(),this.vertex=a,this.queryLabels=[],this.queryDirection=f}function b(a,b){var c=[];return a===e?c.push(b.inEdges):a===d?c.push(b.outEdges):(c.push(b.inEdges),c.push(b.outEdges)),c}return c.mixin(a.prototype,r),c.mixin(a.prototype,{direction:function(a){return c.checkInArray("direction",a,[e,d,f]),this.queryDirection=a,this},labels:function(){return this.queryLabels=c.convertVarArgs(arguments),this},getInitialEdges:function(){return b(this.queryDirection,this.vertex)},getInitialVertices:function(){return b(this.queryDirection,this.vertex)},getBaseFilters:function(){return this.queryLabels.length>0?[new o(this.queryLabels)]:[]},resultExtractor:function(a){return function(b){return a.queryDirection===e?b.getOutVertex():a.queryDirection===d?b.getInVertex():b.getOutVertex()===a.vertex?b.getInVertex():b.getOutVertex()}},count:function(){return this.edges().length}}),a}(),t=function(){function a(a){c.checkExists("Graph",a),this.initQuery(),this.graph=a}return c.mixin(a.prototype,r),c.mixin(a.prototype,{getInitialEdges:function(){var a=this.graph.indexManager.fetchFirstMatching(j,this.hasFilters);return a||(a=this.graph.edges),a},getInitialVertices:function(){var a=this.graph.indexManager.fetchFirstMatching(k,this.hasFilters);return a||(a=this.graph.vertices),a},getBaseFilters:function(){return[]},resultExtractor:function(){return function(a){return a}}}),a}(),u=function(){function a(a,b){c.checkExists("Callback",a),this.callback=a,this.scope=b;var d,e=function(){d=window.requestAnimationFrame(e),a.apply(b)},f=function(){window.cancelAnimationFrame(d)};return{start:e,stop:f}}for(var b=0,d=["ms","moz","webkit","o"],e=0;e<d.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[d[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[d[e]+"CancelAnimationFrame"]||window[d[e]+"CancelRequestAnimationFrame"];return window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var c=(new Date).getTime(),d=Math.max(0,16-(c-b)),e=window.setTimeout(function(){'use strict';a(c+d)},d);return b=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),a}(),v=function(){function a(){this.running=!0}return c.mixin(a.prototype,{step:function(a,b,d,e){if(this.running)for(var f=0;f<a.length;f++){var g=a[f];g.x=c.randomInteger(0,d+1),g.y=c.randomInteger(0,e+1)}return this.running=!1,this.running}}),a}(),w=function(){function a(){}return c.mixin(a.prototype,{step:function(){return!0}}),a}(),x=function(){return{init:function(a,b,d,e){c.checkExists("Container",a),c.checkExists("Graph",e),c.isFunction(this.initEngine)&&this.initEngine(a,b,d,e)},beforeRender:function(){},initVertex:function(){},renderVertex:function(){}}}(),y=function(){function a(){}function b(a,b,c){return a.selectAll("."+b).data(c,function(a){return a.id})}function d(a,b){var c=b.enter().append("g");return c.attr("class",function(b){var c=b[a].getProperty(g),d=a;return c&&(d+=" "+c),d}),c.each(function(b){'use strict';var c=F.getRenderer(b[a],"d3",a);b.g=d3.select(this),c.init(b,b.g)}),c.on("click",function(b){var c=b[a].getGraph();c.trigger(a+"Clicked",b)}),b.exit().remove(),c}function e(a){a.attr("transform",function(a){return"translate("+a.x+","+a.y+")"})}function f(a){var b=d3.behavior.drag();b.on("dragstart",function(a){d3.event.sourceEvent.stopPropagation();var b=a.vertex.getGraph();b.trigger("vertexDragStart",a)}),b.on("drag",function(a){a.x=d3.event.x,a.y=d3.event.y;var b=a.vertex.getGraph();b.trigger("vertexDrag",a)}),b.on("dragend",function(a){var b=a.vertex.getGraph();b.trigger("vertexDragEnd",a)}),a.call(b)}function h(a){a.each(function(a){'use strict';var b=F.getRenderer(a.edge,"d3","edge");b.updatePosition(a)})}return c.mixin(a.prototype,x),c.mixin(a.prototype,{initEngine:function(a,b,c){function d(){e.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")")}var e=this.svg=d3.select(a).append("svg").attr("width",b).attr("height",c).append("g").call(d3.behavior.zoom().scaleExtent([1,8]).on("zoom",d)).append("g");e.append("rect").attr("class","overlay").attr("width",b).attr("height",c);var f=e.append("defs"),g=F.getAll("d3");for(var h in g)g[h].initDefs(f)},beforeRender:function(a,c){var g=b(this.svg,"edge",c);d("edge",g);var i=b(this.svg,"vertex",a),j=d("vertex",i);e(i),f(j),h(g)}}),a}(),z=function(){var a=function(a,b){return{x:a,y:b}},b=function(a,b,c,d){return{x:a,y:b,width:c,height:d}},c=function(a,b){return a.x<b.x},e=function(a,b){return a.y<b.y},f=function(b){return new a(b.x+b.width/2,b.y+b.height/2)},g=function(a,b){return(b.y-a.y)/(b.x-a.x)},h=function(a){return a.height/a.width},i=function(a){return a.g[0][0].getBBox().width},j=function(a){return a.g[0][0].getBBox().height},k=function(b,d){var i=f(b),j=f(d),k=g(i,j),l=h(b),m=b.width/2,n=b.height/2,o=Math.abs(k/l),p=new a((c(i,j)?1:-1)*m,(e(i,j)?1:-1)*n);return 1>o?p.y*=o:p.x/=o,new a(i.x+p.x,i.y+p.y)};return{init:function(a,b){a.uiElement=b.append("path").attr("class","directed-edge arrow").attr("marker-end","url(#arrow)").attr("style","fill: none;stroke: #666;stroke-width: 1.5px;")},initDefs:function(a){a.append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",-1.5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5")},linkCurve:function(a,b,c,d){var e=c-a,f=d-b,g=Math.sqrt(e*e+f*f);return"M"+a+","+b+"Q "+g+" "+f+" "+c+" "+d},updatePosition:function(a){var c=a.uiElement,e=i(a.inVertex),f=j(a.inVertex),g=i(a.outVertex),h=j(a.outVertex),l=new b(a.inVertex.x-e/2,a.inVertex.y-f/2,e,f),m=new b(a.outVertex.x-g/2,a.outVertex.y-h/2,g,h),n=k(m,l),o=k(l,m);a.inVertex.vertex.getEdges(d).forEach(function(a){'use strict';console.log(a.id)}),c.attr("d","M"+n.x+","+n.y+"L"+o.x+" "+o.y)}}}(),A=function(){return{init:function(a,b){a.uiElement=b.append("line")},initDefs:function(){},updatePosition:function(a){var b=a.uiElement;b.attr("x1",function(a){return a.inVertex.x}),b.attr("y1",function(a){return a.inVertex.y}),b.attr("x2",function(a){return a.outVertex.x}),b.attr("y2",function(a){return a.outVertex.y})}}}(),B=function(){return{init:function(a,b){for(var c=a.vertex,d=c.getProperty("filters")||[],e=c.getProperty("alias"),f=25,g=10,h=(1+d.length)*f,i=-h/2+f/2,j=b.append("text").attr("class","alias-label").attr("text-anchor","middle").attr("x",0).attr("y",i).text(e),k=j[0][0].getBBox().width,l=0;l<d.length;l++){var m=d[l];i+=f;var n=B.formatText(m,e,m.propertyKey),o=B.formatText(m,e,m.value),p=B.translateTextWithPredicate(m.predicate,n,o),q=b.append("text").attr("text-anchor","middle").attr("x",0).attr("y",i).text(p);k=q[0][0].getBBox().width>k?q[0][0].getBBox().width:k}var r=5;b.append("line").attr("x1",-(k+2*g)/2).attr("y1",-((h+2*g)/2-f)+r).attr("x2",(k+2*g)/2).attr("y2",-((h+2*g)/2-f)+r).attr("style","stroke: #d5d5d5;"),b.insert("rect",".alias-label").attr("class","query-vertex-box").attr("rx","4").attr("width",k+2*g).attr("height",h+2*g).attr("x",-k/2-g).attr("y",-h/2-g)},initDefs:function(a){var b=a.append("linearGradient").attr("id","White");b.append("stop").attr("id","stop3225").attr("offset","0").attr("style","stop-color:#edebf4;stop-opacity:1"),b.append("stop").attr("id","stop3227").attr("offset","1").attr("style","stop-color:#f9f9f9;stop-opacity:1"),a.append("linearGradient").attr("inkscape:collect","always").attr("xlink:href","#White").attr("id","queryVertexDefaultFillScheme").attr("gradientUnits","userSpaceOnUse").attr("gradientTransform","translate(-348,22)").attr("x1","445.06186").attr("y1","109").attr("x2","463").attr("y2","45")},formatText:function(a,b,c){return a.hasOwnProperty("referencedAlias")?b+"."+c:c},translateTextWithPredicate:function(a,b,c){switch(a){case"LESS_THAN":return b+" < "+c;case"LESS_THAN_EQUAL":return b+" <= "+c;case"GREATER_THAN":return b+" > "+c;case"GREATER_THAN_EQUAL":return b+" >= "+c;case"CONTAINS":return"CONTAINS("+b+","+c+")";case"CONTAINS_PREFIX":return"CONTAINS_PREFIX("+b+","+c+")";case"CONTAINS_REGEX":return"CONTAINS_REGEX("+b+","+c+")";case"PREFIX":return"PREFIX("+b+","+c+")";case"REGEX":return"REGEX("+b+","+c+")";case"EQUAL":return b+" = "+c;case"NOT_EQUAL":return b+decodeURI(" ≠ ")+c;case"IN":return b+decodeURI(" ∈ ")+c;case"NOT_IN":return b+decodeURI(" ∉ ")+c}}}}(),C=function(){function a(a){c.checkExists("Type",a),this.type=a}return c.mixin(a.prototype,{init:function(a,b){var c=b.append("path");c.attr("d",d3.svg.symbol().type(this.type).size(200))},initDefs:function(){}}),a}(),D=function(){function a(){}return c.mixin(a.prototype,x),c.mixin(a.prototype,{initEngine:function(a,b,c){this.paper=new Raphael(a,b,c)},initVertex:function(a){var b=F.getVertexRenderer(a,"raphael");c.checkExists("Renderer",b),b.init(a,this.paper)},renderVertex:function(a){var b=F.getVertexRenderer(a,"raphael");c.checkExists("Renderer",b),b.render(a,this.paper)}}),a}(),E=function(){return{init:function(a,b){a.ui.element=b.rect(0,0,60,40,10)},render:function(a){a.ui.element.attr(a.ui.position)}}}(),F=function(){return{getRenderer:function(a,b,d){var e,f=a.getProperty(g);return null!==f&&(e=c.get(H,b,"vertex"===d?"vertexRenderers":"edgeRenderers",f)),c.isUndefined(e)&&(e=c.get(H,b,"vertex"===d?"defaultVertexRenderer":"defaultEdgeRenderer")),e},getAll:function(a){var b={},d=c.get(H,a);return c.mixin(b,d.vertexRenderers),c.mixin(b,d.edgeRenderers),b},getVertexRenderer:function(a,b){return this.getRenderer(a,b,"vertex")},getEdgeRenderer:function(a,b){return this.getRenderer(a,b,"edge")}}}(),G=function(){function a(a,b,d){c.checkExists("Graph",a),this.graph=a,this.container=b,this.engine=c.isUndefined(d)?H.engine:d,this.width=H.width,this.height=H.height,this.initialized=!1,this.layout=H.layout,this.vertices=[],this.verticesById={},this.edges=[],this.edgesById={}}function b(a,b){a.on("vertexAdded",function(a,c){var d={id:c.getId(),vertex:c};b.vertices.push(d),b.verticesById[d.id]=d}),a.on("edgeAdded",function(a,c){var d=c.getInVertex().getId(),e=c.getOutVertex().getId(),f={id:c.getId(),edge:c,inVertex:b.verticesById[d],outVertex:b.verticesById[e]};b.edges.push(f),b.edgesById[f.id]=f}),a.on("vertexRemoved",function(a,d){var e=b.verticesById[d.getId()];c.remove(e,b.vertices),delete b.verticesById[e.id]}),a.on("edgeRemoved",function(a,d){var e=b.edgesById[d.getId()];c.remove(e,b.edges),delete b.edgesById[e.id]})}return c.mixin(a.prototype,{render:function(){this.initialized||this.init(),this.timer||(this.timer=new u(this.onAnimationFrame,this),this.timer.start())},onAnimationFrame:function(){var a=this.layout.step(this.vertices,this.edges,this.width,this.height);return this.renderFrame(),a},renderFrame:function(){this.engine.beforeRender(this.vertices,this.edges);var a=this;this.graph.forEachVertex(function(b){'use strict';a.engine.renderVertex(b)})},init:function(){b(this.graph,this),this.engine.init(this.container,this.width,this.height,this.graph);var a=this;this.graph.forEachVertex(function(b){'use strict';a.engine.initVertex(b)}),this.initialized=!0}}),a}(),H={engine:new D,layout:new v,raphael:{defaultVertexRenderer:E,vertexRenderers:{}},d3:{defaultVertexRenderer:new C("circle"),defaultEdgeRenderer:z,vertexRenderers:{circle:new C("circle"),cross:new C("cross"),diamond:new C("diamond"),square:new C("square"),"triangle-down":new C("triangle-down"),"triangle-up":new C("triangle-up"),"query-vertex":B},edgeRenderers:{line:z}},width:1280,height:768};a.settings=H,a.Edge=j,a.Vertex=k,a.Graph=l,a.VertexQuery=s,a.GraphQuery=s,a.Index=m,a.RandomLayout=v,a.ForceDirectedLayout=w,a.D3Engine=y,a.D3SymbolVertexRenderer=C,a.D3LineEdgeRenderer=A,a.D3DirectedLineEdgeRenderer=z,a.RaphaelEngine=D,a.RaphaelRectangleVertexRenderer=E,a.Renderer=G,a.OUT=d,a.IN=e,a.BOTH=f,a.PROP_TYPE=g}({},function(){return this}());